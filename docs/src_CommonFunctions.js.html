<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>genesis Source: src/CommonFunctions.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.cosmo.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top navbar-inverse">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">genesis</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="AddBuild.html">AddBuild</a></li><li><a href="AddChannelToDatabase.html">AddChannelToDatabase</a></li><li><a href="AddGuildToDatabase.html">AddGuildToDatabase</a></li><li><a href="AddLFG.html">AddLFG</a></li><li><a href="AddRole.html">AddRole</a></li><li><a href="AlertEmbed.html">AlertEmbed</a></li><li><a href="Alerts.html">Alerts</a></li><li><a href="Arcane.html">Arcane</a></li><li><a href="Armor.html">Armor</a></li><li><a href="AssignDefaultRolesHandle.html">AssignDefaultRolesHandle</a></li><li><a href="Avatar.html">Avatar</a></li><li><a href="Baro.html">Baro</a></li><li><a href="BaseEmbed.html">BaseEmbed</a></li><li><a href="BaseEventHandler.html">BaseEventHandler</a></li><li><a href="Broadcaster.html">Broadcaster</a></li><li><a href="BugReport.html">BugReport</a></li><li><a href="BuildChart.html">BuildChart</a></li><li><a href="BuildEmbed.html">BuildEmbed</a></li><li><a href="Command.html">Command</a></li><li><a href="CommandHandler.html">CommandHandler</a></li><li><a href="ConclaveChallengeEmbed.html">ConclaveChallengeEmbed</a></li><li><a href="ConclaveChallenges.html">ConclaveChallenges</a></li><li><a href="Construction.html">Construction</a></li><li><a href="ConstructionEmbed.html">ConstructionEmbed</a></li><li><a href="Corgi.html">Corgi</a></li><li><a href="Create.html">Create</a></li><li><a href="CreatePool.html">CreatePool</a></li><li><a href="CustomCommand.html">CustomCommand</a></li><li><a href="Damage.html">Damage</a></li><li><a href="Darvo.html">Darvo</a></li><li><a href="DarvoEmbed.html">DarvoEmbed</a></li><li><a href="Database.html">Database</a></li><li><a href="DeleteBuild.html">DeleteBuild</a></li><li><a href="DeleteChannel.html">DeleteChannel</a></li><li><a href="DeleteGuild.html">DeleteGuild</a></li><li><a href="DeleteWebhook.html">DeleteWebhook</a></li><li><a href="Destroy.html">Destroy</a></li><li><a href="EarthCycle.html">EarthCycle</a></li><li><a href="EarthCycleEmbed.html">EarthCycleEmbed</a></li><li><a href="Echo.html">Echo</a></li><li><a href="Efficiency.html">Efficiency</a></li><li><a href="EnableInfoEmbed.html">EnableInfoEmbed</a></li><li><a href="EnableUsageEmbed.html">EnableUsageEmbed</a></li><li><a href="Enemies.html">Enemies</a></li><li><a href="EnemyEmbed.html">EnemyEmbed</a></li><li><a href="EnhancementEmbed.html">EnhancementEmbed</a></li><li><a href="Event.html">Event</a></li><li><a href="EventEmbed.html">EventEmbed</a></li><li><a href="EventHandler.html">EventHandler</a></li><li><a href="FeaturedDeal.html">FeaturedDeal</a></li><li><a href="FissureEmbed.html">FissureEmbed</a></li><li><a href="Fissures.html">Fissures</a></li><li><a href="FrameEmbed.html">FrameEmbed</a></li><li><a href="FrameProfile.html">FrameProfile</a></li><li><a href="FrameStats.html">FrameStats</a></li><li><a href="FrameStatsInline.html">FrameStatsInline</a></li><li><a href="Genesis.html">Genesis</a></li><li><a href="GetBuild.html">GetBuild</a></li><li><a href="GetCommandIds.html">GetCommandIds</a></li><li><a href="Help.html">Help</a></li><li><a href="Hide.html">Hide</a></li><li><a href="Hug.html">Hug</a></li><li><a href="InvasionEmbed.html">InvasionEmbed</a></li><li><a href="Invasions.html">Invasions</a></li><li><a href="Invitation.html">Invitation</a></li><li><a href="Invite.html">Invite</a></li><li><a href="JoinRole.html">JoinRole</a></li><li><a href="Jokes.html">Jokes</a></li><li><a href="LeaveRole.html">LeaveRole</a></li><li><a href="LeaveServer.html">LeaveServer</a></li><li><a href="LFGEmbed.html">LFGEmbed</a></li><li><a href="ListBuilds.html">ListBuilds</a></li><li><a href="Lock.html">Lock</a></li><li><a href="LogEmbed.html">LogEmbed</a></li><li><a href="global.html#Logger">Logger</a></li><li><a href="LogMemberBan.html">LogMemberBan</a></li><li><a href="LogMemberRemove.html">LogMemberRemove</a></li><li><a href="LogMemberUnban.html">LogMemberUnban</a></li><li><a href="LogMessageDelete.html">LogMessageDelete</a></li><li><a href="MessaageManager.html">MessaageManager</a></li><li><a href="Mod.html">Mod</a></li><li><a href="News.html">News</a></li><li><a href="NewsEmbed.html">NewsEmbed</a></li><li><a href="Notifier.html">Notifier</a></li><li><a href="OnReadyHandle.html">OnReadyHandle</a></li><li><a href="Ping.html">Ping</a></li><li><a href="PollInline.html">PollInline</a></li><li><a href="PopularDeal.html">PopularDeal</a></li><li><a href="Prefix.html">Prefix</a></li><li><a href="PriceCheck.html">PriceCheck</a></li><li><a href="PriceCheckEmbed.html">PriceCheckEmbed</a></li><li><a href="PrimeAccess.html">PrimeAccess</a></li><li><a href="ProfileEmbed.html">ProfileEmbed</a></li><li><a href="Progression.html">Progression</a></li><li><a href="Raid.html">Raid</a></li><li><a href="RaidStatEmbed.html">RaidStatEmbed</a></li><li><a href="Reload.html">Reload</a></li><li><a href="RemoveRole.html">RemoveRole</a></li><li><a href="Rename.html">Rename</a></li><li><a href="Resize.html">Resize</a></li><li><a href="Roles.html">Roles</a></li><li><a href="RolesEmbed.html">RolesEmbed</a></li><li><a href="RollInline.html">RollInline</a></li><li><a href="SalesEmbed.html">SalesEmbed</a></li><li><a href="ServerInfo.html">ServerInfo</a></li><li><a href="ServerInfoEmbed.html">ServerInfoEmbed</a></li><li><a href="Servers.html">Servers</a></li><li><a href="SettingsEmbed.html">SettingsEmbed</a></li><li><a href="ShieldEmbed.html">ShieldEmbed</a></li><li><a href="Shields.html">Shields</a></li><li><a href="Show.html">Show</a></li><li><a href="Simaris.html">Simaris</a></li><li><a href="SimarisEmbed.html">SimarisEmbed</a></li><li><a href="SortieEmbed.html">SortieEmbed</a></li><li><a href="Sorties.html">Sorties</a></li><li><a href="StringManager.html">StringManager</a></li><li><a href="SyndicateEmbed.html">SyndicateEmbed</a></li><li><a href="Syndicates.html">Syndicates</a></li><li><a href="Track.html">Track</a></li><li><a href="Tracker.html">Tracker</a></li><li><a href="Unlock.html">Unlock</a></li><li><a href="Untrack.html">Untrack</a></li><li><a href="Updates.html">Updates</a></li><li><a href="UserInfo.html">UserInfo</a></li><li><a href="UserInfoEmbed.html">UserInfoEmbed</a></li><li><a href="Username.html">Username</a></li><li><a href="VoidTraderEmbed.html">VoidTraderEmbed</a></li><li><a href="VulgarNameHandle.html">VulgarNameHandle</a></li><li><a href="WeaponEmbed.html">WeaponEmbed</a></li><li><a href="WeaponStats.html">WeaponStats</a></li><li><a href="WelcomeHandler.html">WelcomeHandler</a></li><li><a href="Whatsin.html">Whatsin</a></li><li><a href="WhatsinEmbed.html">WhatsinEmbed</a></li><li><a href="Whereis.html">Whereis</a></li><li><a href="WhereisEmbed.html">WhereisEmbed</a></li><li><a href="Wiki.html">Wiki</a></li><li><a href="WikiEmbed.html">WikiEmbed</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="global.html#armorAtLevel">armorAtLevel</a></li><li><a href="global.html#armorStrip">armorStrip</a></li><li><a href="global.html#channelNameRegex">channelNameRegex</a></li><li><a href="global.html#checkPrivateRooms">checkPrivateRooms</a></li><li><a href="global.html#client">client</a></li><li><a href="global.html#damageReduction">damageReduction</a></li><li><a href="global.html#formatTime">formatTime</a></li><li><a href="global.html#fromNow">fromNow</a></li><li><a href="global.html#getAverageTime">getAverageTime</a></li><li><a href="global.html#getBestTime">getBestTime</a></li><li><a href="global.html#getChannel">getChannel</a></li><li><a href="global.html#getChannels">getChannels</a></li><li><a href="global.html#getRoleForString">getRoleForString</a></li><li><a href="global.html#getTarget">getTarget</a></li><li><a href="global.html#getUsersForCall">getUsersForCall</a></li><li><a href="global.html#hiddenRegex">hiddenRegex</a></li><li><a href="global.html#lockedRegex">lockedRegex</a></li><li><a href="global.html#noTextRegex">noTextRegex</a></li><li><a href="global.html#publicRegex">publicRegex</a></li><li><a href="global.html#safeNumber">safeNumber</a></li><li><a href="global.html#shownRegex">shownRegex</a></li><li><a href="global.html#sortNumber">sortNumber</a></li><li><a href="global.html#textRegex">textRegex</a></li><li><a href="global.html#timeDeltaToString">timeDeltaToString</a></li><li><a href="global.html#timeToSeconds">timeToSeconds</a></li><li><a href="global.html#updatePresence">updatePresence</a></li><li><a href="global.html#useable">useable</a></li>
				</ul>
			</li>
			
		</ul>
        
            <div class="col-sm-3 col-md-3">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                        <div class="input-group-btn">
                            <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-12">
	
		<div id="main">
			

		<h1 class="page-title">Source: src/CommonFunctions.js</h1>
    
<section>
    <article>
        <pre
            class="sunlight-highlight-javascript linenums">'use strict';

const { eventTypes, rewardTypes, opts } = require('./resources/trackables.json');

const { Collection } = require('discord.js');

const fissures = ['fissures.t1.excavation', 'fissures.t1.sabotage', 'fissures.t1.mobiledefense', 'fissures.t1.assassination', 'fissures.t1.exterminate',
  'fissures.t1.hive', 'fissures.t1.defense', 'fissures.t1.interception', 'fissures.t1.rathuum', 'fissures.t1.conclave', 'fissures.t1.rescue',
  'fissures.t1.spy', 'fissures.t1.survival', 'fissures.t1.capture', 'fissures.t1.darksector', 'fissures.t1.hijack', 'fissures.t1.assault',
  'fissures.t1.evacuation', 'fissures.t2.excavation', 'fissures.t2.sabotage', 'fissures.t2.mobiledefense', 'fissures.t2.assassination',
  'fissures.t2.exterminate', 'fissures.t2.hive', 'fissures.t2.defense', 'fissures.t2.interception', 'fissures.t2.rathuum', 'fissures.t2.conclave',
  'fissures.t2.rescue', 'fissures.t2.spy', 'fissures.t2.survival', 'fissures.t2.capture', 'fissures.t2.darksector', 'fissures.t2.hijack',
  'fissures.t2.assault', 'fissures.t2.evacuation', 'fissures.t3.excavation', 'fissures.t3.sabotage', 'fissures.t3.mobiledefense',
  'fissures.t3.assassination', 'fissures.t3.exterminate', 'fissures.t3.hive', 'fissures.t3.defense', 'fissures.t3.interception',
  'fissures.t3.rathuum', 'fissures.t3.conclave', 'fissures.t3.rescue', 'fissures.t3.spy', 'fissures.t3.survival', 'fissures.t3.capture',
  'fissures.t3.darksector', 'fissures.t3.hijack', 'fissures.t3.assault', 'fissures.t3.evacuation', 'fissures.t4.excavation', 'fissures.t4.sabotage',
  'fissures.t4.mobiledefense', 'fissures.t4.assassination', 'fissures.t4.exterminate', 'fissures.t4.hive', 'fissures.t4.defense',
  'fissures.t4.interception', 'fissures.t4.rathuum', 'fissures.t4.conclave', 'fissures.t4.rescue', 'fissures.t4.spy', 'fissures.t4.survival',
  'fissures.t4.capture', 'fissures.t4.darksector', 'fissures.t4.hijack', 'fissures.t4.assault', 'fissures.t4.evacuation'];

const syndicates = ['syndicate.arbiters', 'syndicate.suda', 'syndicate.loka', 'syndicate.perrin', 'syndicate.veil', 'syndicate.meridian', 'syndicate.ostrons', 'syndicate.assassins'];
const conclave = ['conclave.weeklies', 'conclave.dailies'];
const deals = ['deals.featured', 'deals.popular'];
const clantech = ['mutagen', 'fieldron', 'detonite'];
const resources = ['neuralSensors', 'orokinCell', 'alloyPlate', 'circuits', 'controlModule', 'ferrite', 'gallium', 'morphics', 'nanoSpores', 'oxium', 'rubedo', 'salvage', 'plastids', 'polymerBundle', 'argonCrystal', 'cryotic', 'tellurium'];

const emoji = {
  vazarin: '&lt;:vazarin:319586146269003778>',
  madurai: '&lt;:madurai:319586146499690496>',
  naramon: '&lt;:naramon:319586146478850048>',
  electricity: '&lt;:electricity:321463957212626944>',
  cold: '&lt;:cold:321463957019951105>',
  heat: '&lt;:heat:321463957061763083>',
  toxin: '&lt;:toxin:321463957325873153>',
  radiation: '&lt;:radiation:321463957221277706>',
  viral: '&lt;:viral:321463957292580864>',
  gas: '&lt;:gas:363136257045561344>',
  impact: '&lt;:impact:363136256781189120>',
  puncture: '&lt;:puncture:363136257129185280>',
  slash: '&lt;:slash:363136256755892225>',
  koneski: '&lt;:koneski:319586146483044352>',
  unairu: '&lt;:unairu:319586146453553162>',
  blast: '&lt;:blast:363136256907149312>',
  corrosive: '&lt;:corrosive:363136257288568832>',
  magnetic: '&lt;:magnetic:363136420602445824>',
};

const isVulgarCheck = new RegExp('(n[i!1]gg[e3]r|n[i!1]gg[ua]|h[i!1]tl[e3]r|n[a@]z[i!1]|[©ck]un[t7]|fu[©c]k|[©c]umm?|f[a@4]g|d[i!1]ck|c[o0]ck|boner|sperm|gay|gooch|jizz|pussy|penis|r[i!1]mjob|schlong|slut|wank|whore|sh[i!1]t|sex|fuk|heil|p[o0]rn|pronz|suck|rape|scrotum)', 'ig');

const welcomes = [
  '&lt;:join:349556772412981269> **$username** just joined the server - glhf!',
  '&lt;:join:349556772412981269> **$username** just joined. Everyone, look busy!',
  '&lt;:join:349556772412981269> **$username** just joined. Can I get a heal?',
  '&lt;:join:349556772412981269> **$username** joined your party.',
  '&lt;:join:349556772412981269> **$username** joined. You must construct additional pylons.',
  '&lt;:join:349556772412981269> Ermagherd. **$username** is here.',
  '&lt;:join:349556772412981269> Welcome, **$username**. Stay awhile and listen.',
  '&lt;:join:349556772412981269> Welcome, **$username**. We were expecting you ( ͡° ͜ʖ ͡°)',
  '&lt;:join:349556772412981269> Welcome, **$username**. We hope you brought pizza.',
  '&lt;:join:349556772412981269> Welcome **$username**. Leave your weapons by the door.',
  '&lt;:join:349556772412981269> A wild **$username** appeared.',
  '&lt;:join:349556772412981269> Swoooosh. **$username** just landed.',
  '&lt;:join:349556772412981269> Brace yourselves. **$username** just joined the server.',
  '&lt;:join:349556772412981269> **$username** just joined. Hide your bananas.',
  '&lt;:join:349556772412981269> **$username** just arrived. Seems OP - please nerf.',
  '&lt;:join:349556772412981269> **$username** just slid into the server.',
  '&lt;:join:349556772412981269> A **$username** has spawned in the server.',
  '&lt;:join:349556772412981269> Big **$username** showed up!',
  '&lt;:join:349556772412981269> Where’s **$username**? In the server!',
  '&lt;:join:349556772412981269> **$username** hopped into the server. Kangaroo!!',
  '&lt;:join:349556772412981269> **$username** just showed up. Hold my beer.',
  '&lt;:join:349556772412981269> Relax, **$username**, it\'s a party.',
  '&lt;:join:349556772412981269> Behold before you, the courageous, the charismatic, fashionable...\n**$username**.',
  '&lt;:join:349556772412981269> Oh **$username**, you\'re here! Good to see you weren\'t discouraged by fashion frame.',
  '&lt;:join:349556772412981269> The Tenno **$username** has appeared.',
  '&lt;:join:349556772412981269> **$username** has consigned to the Lotus.',
  '&lt;:join:349556772412981269> **$username** has joined the fight against the Grineer!',
  '&lt;:join:349556772412981269> **$username** has started praising Space Mom.',
  '&lt;:join:349556772412981269> **$username** is ready to save us from Alad V',
  '&lt;:join:349556772412981269> Vay Hek thinks he\'s won, but **$username** has joined',
  '&lt;:join:349556772412981269> **$username** has drunk the Kuva',
  '&lt;:join:349556772412981269> **$username** saved the Ostrons once again!',
  '&lt;:join:349556772412981269> **$username** just arrived at the Community Discord Relay',
  '&lt;:join:349556772412981269> Without **$username** we would\'ve lost the Relays',
  '&lt;:join:349556772412981269> **$username** is a trained ninja at heart',
  '&lt;:join:349556772412981269> **$username** is here, as the prophecy foretold.',
  '&lt;:join:349556772412981269> Swaz-do-lah, **$username**!',
  '&lt;:join:349556772412981269> **$username** has arrived, early lunch for Konzu!',
  '&lt;:join:349556772412981269> **$username**? **$username**?! Ooh, is it my birth interval?',
  '&lt;:join:349556772412981269> I\'m Cephalon Genesis Primary. We have and shall have a long association, **$username**.\nI know this conversation well.',
  '&lt;:join:349556772412981269> Consequence to consequence brings you to us, **$username**',
  '&lt;:join:349556772412981269> **$username**, you were anticipated. Our interaction begins.',
  '&lt;:join:349556772412981269> Drop a stone, a ripple. Drop a grain, nothing of consequence.\nCome to me with stones, **$username**. Instruments of tested power, and I will accept.',
  '&lt;:join:349556772412981269> Oh how I\'ve been looking all over for you, **$username**. Come, come! Let me show you my new venture. I think you\'ll be a perfect fit.',
  '&lt;:join:349556772412981269> It is time. Utter the name, **$username**',
  '&lt;:join:349556772412981269> Yes, the name I have always known, **$username**',
  '&lt;:join:349556772412981269> I\'m detecting a large security force heading your way. It\'s the Gri... No wait, it\'s **$username**. Definitely  **$username**',
  '&lt;:join:349556772412981269> They brought reinforcements... A **$username**',
];

const getRandomWelcome = () => welcomes[Math.floor(Math.random() * welcomes.length)];

function createGroupedArray(arr, chunkSize) {
  const groups = [];
  for (let i = 0; i &lt; arr.length; i += (chunkSize || 10)) {
    groups.push(arr.slice(i, i + (chunkSize || 10)));
  }
  return groups;
}

function trackablesFromParameters(paramString) {
  let items = paramString;
  const cetusCustomTimeRegex = new RegExp('cetus\\.(day|night)\\.[0-1]?[0-9]?[0-9]?', 'ig');

  const trackables = {
    events: [],
    items: [],
  };

  if (items.length > 0) {
    items = items.map(item => item.trim()).filter(item => item.length > 0);
  } else {
    return trackables;
  }

  if (items[0] === 'all') {
    trackables.events = trackables.events.concat(eventTypes);
    trackables.items = trackables.items.concat(rewardTypes);
  } else {
    items.forEach((item) => {
      if (cetusCustomTimeRegex.test(item)) {
        trackables.events.push(item);
      } else if (item === 'items') {
        trackables.items = trackables.items.concat(rewardTypes);
      } else if (item === 'events') {
        trackables.events = trackables.events.concat(eventTypes);
      } else if (item === 'fissures.t1') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('fissures.t1')));
      } else if (item === 'fissures.t2') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('fissures.t2')));
      } else if (item === 'fissures.t3') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('fissures.t3')));
      } else if (item === 'fissures.t4') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('fissures.t4')));
      } else if (item === 'fissures.excavation') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('excavation')));
      } else if (item === 'fissures.sabotage') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('sabotage')));
      } else if (item === 'fissures.mobiledefense') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('mobiledefense')));
      } else if (item === 'fissures.assassination') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('assassination')));
      } else if (item === 'fissures.exterminate') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('exterminate')));
      } else if (item === 'fissures.hive') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('hive')));
      } else if (item === 'fissures.defense') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('defense')));
      } else if (item === 'fissures.interception') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('interception')));
      } else if (item === 'fissures.rathuum') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('rathuum')));
      } else if (item === 'fissures.conclave') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('conclave')));
      } else if (item === 'fissures.rescue') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('rescue')));
      } else if (item === 'fissures.spy') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('spy')));
      } else if (item === 'fissures.survival') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('survival')));
      } else if (item === 'fissures.capture') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('capture')));
      } else if (item === 'fissures.darksector') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('darksector')));
      } else if (item === 'fissures.hijack') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('hijack')));
      } else if (item === 'fissures.assault') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('assault')));
      } else if (item === 'fissures.evacuation') {
        trackables.events = trackables.events
          .concat(fissures.filter(fissure => fissure.includes('evacuation')));
      } else if (item === 'fissures') {
        trackables.events = trackables.events.concat(fissures);
      } else if (item === 'syndicates') {
        trackables.events = trackables.events.concat(syndicates);
      } else if (item === 'conclave') {
        trackables.events = trackables.events.concat(conclave);
      } else if (item === 'deals') {
        trackables.events = trackables.events.concat(deals);
      } else if (item === 'clantech') {
        trackables.items = trackables.items.concat(clantech);
      } else if (item === 'resources') {
        trackables.items = trackables.items.concat(resources);
      } else if (item === 'cetus') {
        trackables.events.push('cetus.day');
        trackables.events.push('cetus.night');
      } else if (rewardTypes.includes(item)) {
        trackables.items.push(item);
      } else if (eventTypes.includes(item)) {
        trackables.events.push(item);
      }
    });
  }
  return trackables;
}

const eventsOrItems = new RegExp(`cetus\\.day\\.[0-1]?[0-9]?[0-9]|cetus\\.night\\.[0-1]?[0-9]?[0-9]|${eventTypes.join('|')}|${rewardTypes.join('|')}|${opts.join('|')}`, 'ig');

function getEventsOrItems(message) {
  const matches = message.strippedContent.match(eventsOrItems);
  return matches || [];
}

function getTrackInstructionEmbed(message, prefix, call) {
  const embed = {
    type: 'rich',
    color: 0x0000ff,
    fields: [
      {
        name: `${prefix}${call} &lt;event(s)/item(s) to ${call === 'untrack' ? 'un' : ''}track>`,
        value: 'Track events/items to be alerted in this channel.',
        inline: true,
      },
      {
        name: 'Possible values:',
        value: '_ _',
        inline: false,
      },
    ],
  };
  createGroupedArray(eventTypes, 35).forEach((group, index) => embed.fields.push({
    name: `**Events${index > 0 ? ' cont\'d.' : ''}:**`,
    value: group.join(' '),
    inline: true,
  }));

  embed.fields.push({
    name: '**Rewards:**',
    value: rewardTypes.join(' '),
    inline: true,
  });
  embed.fields.push({
    name: 'Optional Groups:',
    value: opts.join(' '),
    inline: true,
  });

  switch (call) {
    case 'track':
      embed.fields[0].value = 'Track events/items to be alerted in this channel.';
      break;
    case 'untrack':
      embed.fields[0].value = 'Untrack events/items to be alerted in this channel.';
      break;
    case 'set ping':
      embed.fields[0].value = 'Set the text added before an event/item notification.';
      embed.fields.push({
        name: '**Ping:**',
        value: 'Whatever string you want to be added before a notification for this item or event. If you leave this blank, the ping for this item/event will be cleared',
        inline: true,
      });
      break;
    default:
      break;
  }
  return embed;
}

const emojify = (stringWithoutEmoji) => {
  let stringWithEmoji = stringWithoutEmoji;
  Object.keys(emoji).forEach((identifier) => {
    if (typeof stringWithEmoji === 'string') {
      stringWithEmoji = stringWithEmoji
        .replace(new RegExp(`${identifier}`, 'ig'), ` ${emoji[identifier]}`);
    }
  });
  return stringWithEmoji;
};

const getEmoji = identifier => emoji[identifier] || '';

/**
 * @param   {number} millis The number of milliseconds in the time delta
 * @returns {string}
 */
const timeDeltaToString = (millis) => {
  if (typeof millis !== 'number') {
    throw new TypeError('millis should be a number');
  }
  const timePieces = [];
  const prefix = millis &lt; 0 ? '-' : '';
  let seconds = Math.abs(millis / 1000);

  // Seconds in a day
  if (seconds >= 86400) {
    timePieces.push(`${Math.floor(seconds / 86400)}d`);
    seconds = Math.floor(seconds) % 86400;
  }
  // Seconds in an hour
  if (seconds >= 3600) {
    timePieces.push(`${Math.floor(seconds / 3600)}h`);
    seconds = Math.floor(seconds) % 3600;
  }
  if (seconds >= 60) {
    timePieces.push(`${Math.floor(seconds / 60)}m`);
    seconds = Math.floor(seconds) % 60;
  }
  if (seconds >= 0) {
    timePieces.push(`${Math.floor(seconds)}s`);
  }
  return `${prefix}${timePieces.join(' ')}`;
};

/**
 * Returns the number of milliseconds between now and a given date
 * @param   {Date} d         The date from which the current time will be subtracted
 * @param   {function} [now] A function that returns the current UNIX time in milliseconds
 * @returns {number}
 */
const fromNow = (d, now = Date.now) => d.getTime() - now();

/**
 * Get the list of channels to enable commands in based on the parameters
 * @param {string|Array&lt;Channel>} channelsParam parameter for determining channels
 * @param {Message} message Discord message to get information on channels
 * @param {Collection.&lt;Channel>} channels Channels allowed to be searched through
 * @returns {Array&lt;string>} channel ids to enable commands in
 */
const getChannel = (channelsParam, message, channels) => {
  let { channel } = message;
  let channelsColl;
  if (message.guild) {
    channelsColl = message.guild.channels;
  } else {
    channelsColl = new Collection();
    channelsColl.set(message.channel.id, message.channel);
  }

  if (typeof channelsParam === 'string') {
    // handle it for strings
    if (channelsParam !== 'here') {
      channel = (channels || channelsColl).get(channelsParam.trim());
    } else if (channelsParam === 'here') {
      // eslint-disable-next-line prefer-destructuring
      channel = message.channel;
    }
  }
  return channel;
};

/**
 * Get the list of channels to enable commands in based on the parameters
 * @param {string|Array&lt;Channel>} channelsParam parameter for determining channels
 * @param {Message} message Discord message to get information on channels
 * @returns {Array&lt;string>} channel ids to enable commands in
 */
const getChannels = (channelsParam, message) => {
  let channels = [];
  // handle it for strings
  if (channelsParam !== 'all' &amp;&amp; channelsParam !== 'current') {
    channels.push(message.guild.channels.get(channelsParam.trim().replace(/(&lt;|>|#)/ig, '')));
  } else if (channelsParam === 'all') {
    channels = channels.concat(message.guild.channels.array().filter(channel => channel.type === 'text'));
  } else if (channelsParam === 'current') {
    channels.push(message.channel);
  }
  return channels;
};

/**
 * Get the target role or user from the parameter string
 *    or role mentions or user mentions, preferring the latter 2.
 * @param {string} targetParam string from the command to determine the user or role
 * @param {Array&lt;Role>} roleMentions role mentions from the command
 * @param {Array&lt;User>} userMentions user mentions from the command
 * @param {Message} message message to get information on users and roles
 * @returns {Role|User} target or user to disable commands for
 */
const getTarget = (targetParam, roleMentions, userMentions, message) => {
  let target;
  const roleMention = roleMentions.first();
  const userMention = userMentions.first();
  if (roleMentions.size > 0) {
    target = roleMention;
    target.type = 'Role';
  } else if (userMentions.size > 0) {
    target = userMention;
    target.type = 'User';
  } else {
    const userTarget = message.guild.members.get(targetParam);
    const roleTarget = message.guild.roles.get(targetParam);
    if (targetParam === '*') {
      target = message.guild.defaultRole;
      target.type = 'Role';
    } else if (roleTarget) {
      target = roleTarget;
      target.type = 'Role';
    } else if (userTarget) {
      target = userTarget;
      target.type = 'User';
    } else {
      target = '';
    }
  }
  return target;
};

const resolveRoles = ({ mentions = undefined, content = '', guild = undefined }) => {
  let roles = [];
  if (mentions &amp;&amp; mentions.roles) {
    roles = roles.concat(mentions.roles.array());
  }
  const roleRegex = /(\d{16,19})/g;
  let matches = content.match(roleRegex);
  if (matches &amp;&amp; matches.length) {
    matches.slice(0, 1);
    matches = matches.map((match) => {
      if (guild.roles.has(match)) {
        return guild.roles.get(match);
      }
      return undefined;
    }).filter(match => typeof match !== 'undefined');
  }

  if (matches) {
    roles = [...roles, ...matches];
  }
  return roles;
};

/**
 * Gets the list of users from the mentions in the call
 * @param {Message} message Channel message
 * @param {boolean} excludeAuthor whether or not to exclude the author in the list
 * @returns {Array.&lt;User>} Array of users to send message
 */
const getUsersForCall = (message, excludeAuthor) => {
  const users = [];
  if (message.mentions.roles) {
    message.mentions.roles.forEach(role =>
      role.members.forEach(member =>
        users.push(member.user)));
  }
  if (message.mentions.users) {
    message.mentions.users.forEach((user) => {
      if (users.indexOf(user) === -1) {
        users.push(user);
      }
    });
  }
  if (!excludeAuthor) {
    let authorIncluded = false;
    users.forEach((user) => {
      if (user.id === message.author.id) {
        authorIncluded = true;
      }
    });
    if (!authorIncluded) {
      users.push(message.author);
    }
  }
  return users;
};

const resolvePool = async (message, settings,
  {
    explicitOnly = false,
    skipManages = false,
    pool = undefined,
    checkRestriction = false,
    allowMultiple = false,
  } = { explicitOnly: false, skipManages: false }) => {
  let poolId = pool;
  if (!skipManages &amp;&amp; !await settings.userManagesPool(message.author, poolId)) {
    poolId = undefined;
  } else {
    return poolId;
  }
  const explicitPoolMatches = message.strippedContent.match(/(?:--pool\s+([a-zA-Z0-9-]*))/i);

  if (!poolId &amp;&amp; explicitPoolMatches &amp;&amp; explicitPoolMatches.length > 1) {
    [, poolId] = explicitPoolMatches;
    if (!skipManages &amp;&amp; !(await settings.userManagesPool(message.author, poolId))) {
      poolId = undefined;
    }
  } else if (!explicitOnly) {
    let pools = (await settings.getPoolsUserManages(message.author))
      .map(poolRow => poolRow.pool_id);
    if (pools.length > 1 &amp;&amp; allowMultiple) {
      return pools;
    }
    if (pools.length === 1) {
      [poolId] = pools;
    } else if (pools.length === 0) {
      poolId = undefined;
    } else if (await settings.getGuildsPool(message.guild).length) {
      pools = await settings.getGuildsPool(message.guild);
      if (pools.length === 1
        &amp;&amp; (skipManages || await settings.userManagesPool(message.author, pools[0]))) {
        [poolId] = pools;
      }
    } else {
      poolId = undefined;
    }
  }

  if (poolId &amp;&amp; checkRestriction &amp;&amp; await settings.isPoolRestricted(poolId)) {
    poolId = undefined;
  }
  return poolId;
};

const createPageCollector = async (msg, pages, author) => {
  let page = 1;
  await msg.react('◀');
  await msg.react('▶');
  const collector = msg.createReactionCollector((reaction, user) => ((reaction.emoji.name === '◀' || reaction.emoji.name === '▶') &amp;&amp; user.id === author.id), { time: 120000 });

  collector.on('collect', async (reaction) => {
    if (reaction.emoji.name === '◀') {
      if (page > 1) page -= 1;
    } else if (reaction.emoji.name === '▶') {
      if (page &lt;= pages.length) page += 1;
    }
    await reaction.remove(author.id);
    if (page &lt;= pages.length &amp;&amp; page > 0) {
      const newPage = pages[page - 1];
      const pageInd = `Page ${page}/${pages.length}`;
      if (newPage.footer) {
        if (newPage.footer.text) {
          if (newPage.footer.text.indexOf('Page') === -1) {
            newPage.footer.text = `${pageInd} • ${newPage.footer.text}`;
          }
        } else {
          newPage.footer.text = pageInd;
        }
      } else {
        newPage.footer = { text: pageInd };
      }
      msg.edit({ embed: newPage });
    } else if (page &lt; 1) {
      page = 1;
    } else if (page >= pages.length) {
      page = pages.length;
    }
  });
};

module.exports = {
  createGroupedArray,
  emojify,
  fromNow,
  getChannel,
  getChannels,
  getEmoji,
  getEventsOrItems,
  getTarget,
  getTrackInstructionEmbed,
  getUsersForCall,
  timeDeltaToString,
  trackablesFromParameters,
  isVulgarCheck,
  getRandomWelcome,
  resolveRoles,
  resolvePool,
  createPageCollector,
};
</pre>
    </article>
</section>





		</div>
	</div>

	<div class="clearfix"></div>

	

</div>
</div>


    <div class="modal fade" id="searchResults">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Search results</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div>


<footer>


<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a>
	
		on Sunday, June 3rd 2018, 01:04:04
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>

    <script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>


<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre, pre.prettyprint.source" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : true,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			return $( heading ).attr( "id" ) || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->

<script>
	$( function () {
		$( '#main' ).localScroll( {
			offset : { top : 60 } //offset by the height of your header (give or take a few px, see what works for you)
		} );
		$( "dt.name" ).each( function () {
			var $this = $( this ).find("h4");
			var icon = $( "<i/>" ).addClass( "icon-plus-sign" ).addClass( "pull-right" ).addClass( "icon-white" );
			var dt = $(this);
			var children = dt.next( "dd" );

			dt.prepend( icon ).css( {cursor : "pointer"} );
			dt.addClass( "member-collapsed" ).addClass( "member" );


			children.hide();

			dt.children().on( "click", function () {
				children = dt.next( "dd" );
				children.slideToggle( "fast", function () {

					if ( children.is( ":visible" ) ) {
						icon.addClass( "icon-minus-sign" ).removeClass( "icon-plus-sign" ).removeClass( "icon-white" );
						dt.addClass( "member-open" ).animate( "member-collapsed" );
					} else {
						icon.addClass( "icon-plus-sign" ).removeClass( "icon-minus-sign" ).addClass( "icon-white" );
						dt.addClass( "member-collapsed" ).removeClass( "member-open" );
					}
				} );
			} );

		} );
	} );
</script>


<!--Google Analytics-->



    <script type="text/javascript">
        $(document).ready(function() {
            SearcherDisplay.init();
        });
    </script>


</body>
</html>
